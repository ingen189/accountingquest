<!DOCTYPE html>
<html lang="no" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîê AccountingQuest Admin</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>‚öôÔ∏è</text></svg>">
    
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    
    <style>
        :root {
            --bg-primary: #0f1419;
            --bg-secondary: #1a1f2e;
            --bg-tertiary: #252b3b;
            --text-primary: #e7e9ea;
            --text-secondary: #8b98a5;
            --accent: #4ade80;
            --accent-hover: #22c55e;
            --danger: #ef4444;
            --warning: #f59e0b;
            --info: #3b82f6;
            --border: #2f3542;
            --success: #10b981;
        }
        
        * { box-sizing: border-box; margin: 0; padding: 0; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
        }
        
        /* Login Screen */
        .login-screen {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 20px;
        }
        
        .login-box {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 40px;
            max-width: 400px;
            width: 100%;
            text-align: center;
        }
        
        .login-box h1 {
            font-size: 2rem;
            margin-bottom: 10px;
        }
        
        .login-box p {
            color: var(--text-secondary);
            margin-bottom: 30px;
        }
        
        .login-box input {
            width: 100%;
            padding: 14px 16px;
            border: 1px solid var(--border);
            border-radius: 8px;
            background: var(--bg-tertiary);
            color: var(--text-primary);
            font-size: 16px;
            margin-bottom: 15px;
        }
        
        .login-box input:focus {
            outline: none;
            border-color: var(--accent);
        }
        
        .login-box button {
            width: 100%;
            padding: 14px;
            background: var(--accent);
            color: #000;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .login-box button:hover {
            background: var(--accent-hover);
        }
        
        .login-error {
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid var(--danger);
            color: var(--danger);
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 15px;
            display: none;
        }
        
        /* Admin Layout */
        .admin-container {
            display: none;
        }
        
        .admin-header {
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border);
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .admin-header h1 {
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .admin-user {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .admin-user span {
            color: var(--text-secondary);
            font-size: 14px;
        }
        
        .btn-logout {
            padding: 8px 16px;
            background: transparent;
            border: 1px solid var(--border);
            color: var(--text-secondary);
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
        }
        
        .btn-logout:hover {
            border-color: var(--danger);
            color: var(--danger);
        }
        
        /* Tabs */
        .admin-tabs {
            display: flex;
            gap: 5px;
            padding: 15px 30px;
            background: var(--bg-secondary);
            border-bottom: 1px solid var(--border);
            overflow-x: auto;
        }
        
        .tab-btn {
            padding: 10px 20px;
            background: transparent;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            border-radius: 8px;
            font-size: 14px;
            white-space: nowrap;
            transition: all 0.2s;
        }
        
        .tab-btn:hover {
            background: var(--bg-tertiary);
            color: var(--text-primary);
        }
        
        .tab-btn.active {
            background: var(--accent);
            color: #000;
            font-weight: 600;
        }
        
        /* Content */
        .admin-content {
            padding: 30px;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .tab-panel {
            display: none;
        }
        
        .tab-panel.active {
            display: block;
        }
        
        /* Cards */
        .card {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 24px;
            margin-bottom: 20px;
        }
        
        .card h2 {
            font-size: 1.2rem;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .card p {
            color: var(--text-secondary);
            margin-bottom: 15px;
        }
        
        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
        }
        
        .stat-card .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--accent);
        }
        
        .stat-card .stat-label {
            color: var(--text-secondary);
            font-size: 14px;
            margin-top: 5px;
        }
        
        /* Buttons */
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn-primary {
            background: var(--accent);
            color: #000;
        }
        
        .btn-primary:hover {
            background: var(--accent-hover);
        }
        
        .btn-secondary {
            background: var(--bg-tertiary);
            color: var(--text-primary);
            border: 1px solid var(--border);
        }
        
        .btn-secondary:hover {
            border-color: var(--accent);
        }
        
        .btn-danger {
            background: var(--danger);
            color: white;
        }
        
        .btn-danger:hover {
            background: #dc2626;
        }
        
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .btn-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        /* Log/Output */
        .log-output {
            background: #0d1117;
            border: 1px solid var(--border);
            border-radius: 8px;
            padding: 15px;
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 13px;
            max-height: 400px;
            overflow-y: auto;
            white-space: pre-wrap;
            word-break: break-all;
        }
        
        .log-output .log-success { color: var(--success); }
        .log-output .log-error { color: var(--danger); }
        .log-output .log-warning { color: var(--warning); }
        .log-output .log-info { color: var(--info); }
        
        /* Form Elements */
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid var(--border);
            border-radius: 8px;
            background: var(--bg-tertiary);
            color: var(--text-primary);
            font-size: 14px;
        }
        
        .form-group textarea {
            min-height: 150px;
            font-family: 'Monaco', 'Menlo', monospace;
            resize: vertical;
        }
        
        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: var(--accent);
        }
        
        /* Data Table */
        .data-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .data-table th,
        .data-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }
        
        .data-table th {
            background: var(--bg-tertiary);
            font-weight: 600;
            font-size: 13px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            color: var(--text-secondary);
        }
        
        .data-table tr:hover td {
            background: var(--bg-tertiary);
        }
        
        /* Badge */
        .badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }
        
        .badge-success { background: rgba(16, 185, 129, 0.2); color: var(--success); }
        .badge-warning { background: rgba(245, 158, 11, 0.2); color: var(--warning); }
        .badge-danger { background: rgba(239, 68, 68, 0.2); color: var(--danger); }
        .badge-info { background: rgba(59, 130, 246, 0.2); color: var(--info); }
        
        /* Progress Bar */
        .progress-bar {
            height: 8px;
            background: var(--bg-tertiary);
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .progress-bar .progress-fill {
            height: 100%;
            background: var(--accent);
            border-radius: 4px;
            transition: width 0.3s;
        }
        
        /* Loading Spinner */
        .spinner {
            width: 20px;
            height: 20px;
            border: 2px solid var(--border);
            border-top-color: var(--accent);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Seed Section */
        .seed-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .seed-card {
            background: var(--bg-secondary);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 24px;
        }
        
        .seed-card h3 {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }
        
        .seed-card p {
            color: var(--text-secondary);
            font-size: 14px;
            margin-bottom: 15px;
        }
        
        .seed-card .seed-count {
            font-size: 2rem;
            font-weight: 700;
            color: var(--accent);
            margin-bottom: 15px;
        }
        
        /* JSON Editor */
        .json-editor {
            background: #0d1117;
            border: 1px solid var(--border);
            border-radius: 8px;
            overflow: hidden;
        }
        
        .json-editor-header {
            background: var(--bg-tertiary);
            padding: 10px 15px;
            border-bottom: 1px solid var(--border);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .json-editor textarea {
            width: 100%;
            min-height: 400px;
            padding: 15px;
            background: transparent;
            border: none;
            color: var(--text-primary);
            font-family: 'Monaco', 'Menlo', monospace;
            font-size: 13px;
            resize: vertical;
        }
        
        .json-editor textarea:focus {
            outline: none;
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .admin-header {
                padding: 15px;
                flex-direction: column;
                gap: 15px;
            }
            
            .admin-tabs {
                padding: 10px 15px;
            }
            
            .admin-content {
                padding: 15px;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <!-- Login Screen -->
    <div class="login-screen" id="loginScreen">
        <div class="login-box">
            <h1>üîê Admin Portal</h1>
            <p>AccountingQuest Administration</p>
            
            <div class="login-error" id="loginError"></div>
            
            <input type="email" id="loginEmail" placeholder="E-post" autocomplete="email">
            <input type="password" id="loginPassword" placeholder="Passord" autocomplete="current-password">
            <button onclick="handleLogin()">Logg inn</button>
            
            <p style="margin-top: 20px; font-size: 12px;">
                Kun autoriserte administratorer har tilgang
            </p>
        </div>
    </div>
    
    <!-- Admin Container -->
    <div class="admin-container" id="adminContainer">
        <header class="admin-header">
            <h1>‚öôÔ∏è AccountingQuest Admin</h1>
            <div class="admin-user">
                <span id="userEmail"></span>
                <button class="btn-logout" onclick="handleLogout()">Logg ut</button>
            </div>
        </header>
        
        <nav class="admin-tabs">
            <button class="tab-btn active" data-tab="dashboard">üìä Dashboard</button>
            <button class="tab-btn" data-tab="wiki">üìñ Wiki</button>
            <button class="tab-btn" data-tab="quiz">‚ùì Quiz</button>
            <button class="tab-btn" data-tab="bokforing">üìí Bokf√∏ring</button>
            <button class="tab-btn" data-tab="corpfin">üíº Corporate Finance</button>
            <button class="tab-btn" data-tab="database">üóÑÔ∏è Database</button>
            <button class="tab-btn" data-tab="settings">‚öôÔ∏è Innstillinger</button>
        </nav>
        
        <main class="admin-content">
            <!-- Dashboard Tab -->
            <div class="tab-panel active" id="tab-dashboard">
                <h2 style="margin-bottom: 20px;">üìä Oversikt</h2>
                
                <div class="stats-grid" id="statsGrid">
                    <div class="stat-card">
                        <div class="stat-value" id="statWiki">-</div>
                        <div class="stat-label">Wiki-artikler</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="statQuiz">-</div>
                        <div class="stat-label">Quiz-sp√∏rsm√•l</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="statBokforing">-</div>
                        <div class="stat-label">Bokf√∏ringsoppgaver</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="statCorpFin">-</div>
                        <div class="stat-label">Corp Finance</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="statUsers">-</div>
                        <div class="stat-label">Brukere</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="statTeachers">-</div>
                        <div class="stat-label">L√¶rere</div>
                    </div>
                </div>
                
                <div class="card">
                    <h2>üöÄ Hurtighandlinger</h2>
                    <div class="btn-group">
                        <button class="btn btn-primary" onclick="switchTab('wiki')">üìñ Seed Wiki</button>
                        <button class="btn btn-primary" onclick="switchTab('quiz')">‚ùì Seed Quiz</button>
                        <button class="btn btn-primary" onclick="switchTab('corpfin')">üíº Seed Corp Fin</button>
                        <button class="btn btn-secondary" onclick="refreshStats()">üîÑ Oppdater stats</button>
                    </div>
                </div>
                
                <div class="card">
                    <h2>üìã Siste aktivitet</h2>
                    <div class="log-output" id="activityLog">Laster aktivitetslogg...</div>
                </div>
            </div>
            
            <!-- Wiki Tab -->
            <div class="tab-panel" id="tab-wiki">
                <h2 style="margin-bottom: 20px;">üìñ Wiki-administrasjon</h2>
                
                <div class="seed-section">
                    <div class="seed-card">
                        <h3>üå± Seed Wiki-artikler</h3>
                        <p>Last inn standard wiki-artikler til databasen</p>
                        <div class="seed-count" id="wikiSeedCount">20+</div>
                        <p>artikler klar til seeding</p>
                        <div class="btn-group">
                            <button class="btn btn-primary" onclick="seedWiki()">
                                Seed Wiki
                            </button>
                            <button class="btn btn-secondary" onclick="previewWiki()">
                                üëÅÔ∏è Forh√•ndsvis
                            </button>
                        </div>
                    </div>
                    
                    <div class="seed-card">
                        <h3>üìä N√•v√¶rende status</h3>
                        <p>Artikler i databasen</p>
                        <div class="seed-count" id="wikiCurrentCount">-</div>
                        <p>artikler lagret</p>
                        <div class="btn-group">
                            <button class="btn btn-secondary" onclick="loadWikiArticles()">
                                üîÑ Oppdater
                            </button>
                            <button class="btn btn-danger" onclick="clearWiki()">
                                üóëÔ∏è T√∏m Wiki
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="card" style="margin-top: 20px;">
                    <h2>üìù Legg til ny artikkel</h2>
                    <div class="form-group">
                        <label>Tittel</label>
                        <input type="text" id="wikiTitle" placeholder="F.eks. MVAL ¬ß 8-1 - Fradragsrett">
                    </div>
                    <div class="form-group">
                        <label>Kategori</label>
                        <select id="wikiCategory">
                            <option value="lovverk">üìú Lovverk</option>
                            <option value="formler">üìê Formler</option>
                            <option value="kontoplan">üìä Kontoplan</option>
                            <option value="konsepter">üí° Konsepter</option>
                            <option value="standarder">üìã Standarder</option>
                            <option value="annet">üìÅ Annet</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Lov (valgfri)</label>
                        <input type="text" id="wikiLaw" placeholder="F.eks. MVAL, RSKL, SKTL">
                    </div>
                    <div class="form-group">
                        <label>Paragraf (valgfri)</label>
                        <input type="text" id="wikiParagraph" placeholder="F.eks. ¬ß 8-1">
                    </div>
                    <div class="form-group">
                        <label>Tags (kommaseparert)</label>
                        <input type="text" id="wikiTags" placeholder="mva, fradrag, inng√•ende">
                    </div>
                    <div class="form-group">
                        <label>Kontoer (kommaseparert)</label>
                        <input type="text" id="wikiAccounts" placeholder="2710, 2711">
                    </div>
                    <div class="form-group">
                        <label>Sammendrag</label>
                        <input type="text" id="wikiSummary" placeholder="Kort beskrivelse">
                    </div>
                    <div class="form-group">
                        <label>Innhold (HTML)</label>
                        <textarea id="wikiContent" placeholder="<h2>Tittel</h2><p>Innhold...</p>"></textarea>
                    </div>
                    <button class="btn btn-primary" onclick="addWikiArticle()">‚ûï Legg til artikkel</button>
                </div>
                
                <div class="card" style="margin-top: 20px;">
                    <h2>üìã Logg</h2>
                    <div class="log-output" id="wikiLog">Klar...</div>
                </div>
            </div>
            
            <!-- Quiz Tab -->
            <div class="tab-panel" id="tab-quiz">
                <h2 style="margin-bottom: 20px;">‚ùì Quiz-administrasjon</h2>
                
                <div class="seed-section">
                    <div class="seed-card">
                        <h3>üå± Seed Quiz-sp√∏rsm√•l</h3>
                        <p>Last inn quiz-sp√∏rsm√•l fra hardkodet data</p>
                        <div class="seed-count">245+</div>
                        <p>sp√∏rsm√•l tilgjengelig</p>
                        <div class="btn-group">
                            <button class="btn btn-primary" onclick="seedQuiz()">
                                Seed Quiz
                            </button>
                            <button class="btn btn-secondary" onclick="previewQuiz()">
                                üëÅÔ∏è Forh√•ndsvis
                            </button>
                        </div>
                    </div>
                    
                    <div class="seed-card">
                        <h3>üìä N√•v√¶rende status</h3>
                        <p>Sp√∏rsm√•l i databasen</p>
                        <div class="seed-count" id="quizCurrentCount">-</div>
                        <p>sp√∏rsm√•l lagret</p>
                        <div class="btn-group">
                            <button class="btn btn-secondary" onclick="loadQuizStats()">
                                üîÑ Oppdater
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="card" style="margin-top: 20px;">
                    <h2>üìù Legg til nytt sp√∏rsm√•l</h2>
                    <div class="form-group">
                        <label>Kategori</label>
                        <select id="quizCategory">
                            <option value="mva">MVA</option>
                            <option value="regnskap">Regnskap</option>
                            <option value="skatt">Skatt</option>
                            <option value="bokforing">Bokf√∏ring</option>
                            <option value="revisjon">Revisjon</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Type</label>
                        <select id="quizType">
                            <option value="mc">Flervalg</option>
                            <option value="tf">Sant/Usant</option>
                            <option value="input">Tekstsvar</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Sp√∏rsm√•l</label>
                        <textarea id="quizQuestion" placeholder="Skriv sp√∏rsm√•let her..." style="min-height: 80px;"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Svaralternativer (JSON array for flervalg)</label>
                        <textarea id="quizOptions" placeholder='["Alternativ A", "Alternativ B", "Alternativ C", "Alternativ D"]' style="min-height: 60px;"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Riktig svar (index for flervalg, tekst for andre)</label>
                        <input type="text" id="quizAnswer" placeholder="0 (for f√∏rste alternativ)">
                    </div>
                    <div class="form-group">
                        <label>Forklaring</label>
                        <textarea id="quizExplanation" placeholder="Forklaring p√• hvorfor dette er riktig..." style="min-height: 80px;"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Lovhenvisning (valgfri)</label>
                        <input type="text" id="quizLaw" placeholder="F.eks. ¬ß 8-1 (MVAL)">
                    </div>
                    <button class="btn btn-primary" onclick="addQuizQuestion()">‚ûï Legg til sp√∏rsm√•l</button>
                </div>
                
                <div class="card" style="margin-top: 20px;">
                    <h2>üìã Logg</h2>
                    <div class="log-output" id="quizLog">Klar...</div>
                </div>
            </div>
            
            <!-- Bokf√∏ring Tab -->
            <div class="tab-panel" id="tab-bokforing">
                <h2 style="margin-bottom: 20px;">üìí Bokf√∏rings-administrasjon</h2>
                
                <div class="seed-section">
                    <div class="seed-card">
                        <h3>üå± Seed Bokf√∏ringsoppgaver</h3>
                        <p>Last inn bokf√∏ringsoppgaver</p>
                        <div class="seed-count">50+</div>
                        <p>oppgaver tilgjengelig</p>
                        <div class="btn-group">
                            <button class="btn btn-primary" onclick="seedBokforing()">
                                Seed Bokf√∏ring
                            </button>
                        </div>
                    </div>
                    
                    <div class="seed-card">
                        <h3>üìä N√•v√¶rende status</h3>
                        <div class="seed-count" id="bokforingCurrentCount">-</div>
                        <p>oppgaver lagret</p>
                        <div class="btn-group">
                            <button class="btn btn-secondary" onclick="loadBokforingStats()">
                                üîÑ Oppdater
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="card" style="margin-top: 20px;">
                    <h2>üìã Logg</h2>
                    <div class="log-output" id="bokforingLog">Klar...</div>
                </div>
            </div>
            
            <!-- Corporate Finance Tab -->
            <div class="tab-panel" id="tab-corpfin">
                <h2 style="margin-bottom: 20px;">üíº Corporate Finance</h2>
                
                <div class="seed-section">
                    <div class="seed-card">
                        <h3>üå± Seed Corp Finance</h3>
                        <p>Last inn corporate finance sp√∏rsm√•l</p>
                        <div class="seed-count">100+</div>
                        <p>sp√∏rsm√•l tilgjengelig</p>
                        <div class="btn-group">
                            <button class="btn btn-primary" onclick="seedCorpFin()">
                                Seed Corp Fin
                            </button>
                        </div>
                    </div>
                    
                    <div class="seed-card">
                        <h3>üìä N√•v√¶rende status</h3>
                        <div class="seed-count" id="corpfinCurrentCount">-</div>
                        <p>sp√∏rsm√•l lagret</p>
                        <div class="btn-group">
                            <button class="btn btn-secondary" onclick="loadCorpFinStats()">
                                üîÑ Oppdater
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="card" style="margin-top: 20px;">
                    <h2>üìã Logg</h2>
                    <div class="log-output" id="corpfinLog">Klar...</div>
                </div>
            </div>
            
            <!-- Database Tab -->
            <div class="tab-panel" id="tab-database">
                <h2 style="margin-bottom: 20px;">üóÑÔ∏è Database Explorer</h2>
                
                <div class="card">
                    <h2>üìÇ Velg node</h2>
                    <div class="btn-group" style="margin-bottom: 20px;">
                        <button class="btn btn-secondary" onclick="loadDbNode('wiki/articles')">Wiki</button>
                        <button class="btn btn-secondary" onclick="loadDbNode('questions/quiz')">Quiz</button>
                        <button class="btn btn-secondary" onclick="loadDbNode('questions/bokforing')">Bokf√∏ring</button>
                        <button class="btn btn-secondary" onclick="loadDbNode('questions/corporate_finance')">Corp Fin</button>
                        <button class="btn btn-secondary" onclick="loadDbNode('users')">Brukere</button>
                        <button class="btn btn-secondary" onclick="loadDbNode('teachers')">L√¶rere</button>
                        <button class="btn btn-secondary" onclick="loadDbNode('classrooms')">Klasserom</button>
                        <button class="btn btn-secondary" onclick="loadDbNode('games')">Spill</button>
                    </div>
                    
                    <div class="form-group">
                        <label>Egendefinert path</label>
                        <div style="display: flex; gap: 10px;">
                            <input type="text" id="dbPath" placeholder="wiki/articles/mval-8-1" style="flex: 1;">
                            <button class="btn btn-primary" onclick="loadDbNode(document.getElementById('dbPath').value)">Hent</button>
                        </div>
                    </div>
                </div>
                
                <div class="json-editor">
                    <div class="json-editor-header">
                        <span id="dbCurrentPath">Ingen node valgt</span>
                        <div class="btn-group">
                            <button class="btn btn-secondary" onclick="formatJson()">Formater</button>
                            <button class="btn btn-primary" onclick="saveDbNode()">üíæ Lagre</button>
                            <button class="btn btn-danger" onclick="deleteDbNode()">üóëÔ∏è Slett</button>
                        </div>
                    </div>
                    <textarea id="dbEditor" placeholder="Velg en node for √• se data..."></textarea>
                </div>
            </div>
            
            <!-- Settings Tab -->
            <div class="tab-panel" id="tab-settings">
                <h2 style="margin-bottom: 20px;">‚öôÔ∏è Innstillinger</h2>
                
                <div class="card">
                    <h2>üë§ Admin-konfigurering</h2>
                    <p>Endre admin e-postadresse i koden for √• gi tilgang til andre</p>
                    
                    <div class="form-group">
                        <label>N√•v√¶rende admin</label>
                        <input type="text" value="" id="currentAdmin" readonly>
                    </div>
                </div>
                
                <div class="card">
                    <h2>üîê Firebase Rules</h2>
                    <p>Kopier og lim inn i Firebase Console ‚Üí Realtime Database ‚Üí Rules</p>
                    <div class="btn-group">
                        <button class="btn btn-secondary" onclick="showRules()">Vis Rules JSON</button>
                        <button class="btn btn-secondary" onclick="copyRules()">üìã Kopier Rules</button>
                    </div>
                </div>
                
                <div class="card">
                    <h2>‚ö†Ô∏è Farlige handlinger</h2>
                    <div class="btn-group">
                        <button class="btn btn-danger" onclick="clearAllData()">üóëÔ∏è Slett ALL data</button>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // ========================================
        // CONFIGURATION
        // ========================================
        
        // ENDRE DENNE til din e-postadresse!
        const ADMIN_EMAILS = [
            'truls@accountingquest.app',
            'admin@accountingquest.app'
            // Legg til flere admin-epostadresser her
        ];
        
        // Firebase config
        const firebaseConfig = {
            apiKey: "AIzaSyAPuacYOSf4Hv-h36yA5Hav67SlpIFMIIQ",
            authDomain: "accountingquest-multiplayer.firebaseapp.com",
            databaseURL: "https://accountingquest-multiplayer-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "accountingquest-multiplayer",
            storageBucket: "accountingquest-multiplayer.firebasestorage.app",
            messagingSenderId: "525417361926",
            appId: "1:525417361926:web:ec9b737f82af9b21700987"
        };
        
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.database();
        
        // ========================================
        // AUTH FUNCTIONS
        // ========================================
        
        async function handleLogin() {
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            const errorEl = document.getElementById('loginError');
            
            if (!email || !password) {
                errorEl.textContent = 'Fyll inn e-post og passord';
                errorEl.style.display = 'block';
                return;
            }
            
            try {
                const result = await auth.signInWithEmailAndPassword(email, password);
                
                // Check if admin
                if (!ADMIN_EMAILS.includes(result.user.email.toLowerCase())) {
                    await auth.signOut();
                    errorEl.textContent = 'Du har ikke admin-tilgang';
                    errorEl.style.display = 'block';
                    return;
                }
                
                showAdminPanel(result.user);
            } catch (error) {
                console.error('Login error:', error);
                let msg = 'Innlogging feilet';
                if (error.code === 'auth/user-not-found') msg = 'Bruker ikke funnet';
                if (error.code === 'auth/wrong-password') msg = 'Feil passord';
                if (error.code === 'auth/invalid-email') msg = 'Ugyldig e-post';
                errorEl.textContent = msg;
                errorEl.style.display = 'block';
            }
        }
        
        function handleLogout() {
            auth.signOut().then(() => {
                document.getElementById('adminContainer').style.display = 'none';
                document.getElementById('loginScreen').style.display = 'flex';
            });
        }
        
        function showAdminPanel(user) {
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('adminContainer').style.display = 'block';
            document.getElementById('userEmail').textContent = user.email;
            document.getElementById('currentAdmin').value = user.email;
            
            // Load initial stats
            refreshStats();
        }
        
        // Check auth state on load
        auth.onAuthStateChanged(user => {
            if (user && ADMIN_EMAILS.includes(user.email?.toLowerCase())) {
                showAdminPanel(user);
            }
        });
        
        // Enter key to login
        document.getElementById('loginPassword').addEventListener('keypress', e => {
            if (e.key === 'Enter') handleLogin();
        });
        
        // ========================================
        // TAB NAVIGATION
        // ========================================
        
        document.querySelectorAll('.tab-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                const tab = btn.dataset.tab;
                switchTab(tab);
            });
        });
        
        function switchTab(tabId) {
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));
            
            document.querySelector(`[data-tab="${tabId}"]`).classList.add('active');
            document.getElementById(`tab-${tabId}`).classList.add('active');
        }
        
        // ========================================
        // STATS & DASHBOARD
        // ========================================
        
        async function refreshStats() {
            try {
                // Wiki count
                const wikiSnap = await db.ref('wiki/articles').once('value');
                const wikiCount = wikiSnap.exists() ? Object.keys(wikiSnap.val()).length : 0;
                document.getElementById('statWiki').textContent = wikiCount;
                document.getElementById('wikiCurrentCount').textContent = wikiCount;
                
                // Quiz count
                const quizSnap = await db.ref('questions/quiz').once('value');
                let quizCount = 0;
                if (quizSnap.exists()) {
                    Object.values(quizSnap.val()).forEach(cat => {
                        if (typeof cat === 'object') quizCount += Object.keys(cat).length;
                    });
                }
                document.getElementById('statQuiz').textContent = quizCount;
                document.getElementById('quizCurrentCount').textContent = quizCount;
                
                // Bokf√∏ring count
                const bokSnap = await db.ref('questions/bokforing').once('value');
                let bokCount = 0;
                if (bokSnap.exists()) {
                    Object.values(bokSnap.val()).forEach(diff => {
                        if (typeof diff === 'object') bokCount += Object.keys(diff).length;
                    });
                }
                document.getElementById('statBokforing').textContent = bokCount;
                document.getElementById('bokforingCurrentCount').textContent = bokCount;
                
                // Corp Fin count
                const corpSnap = await db.ref('questions/corporate_finance').once('value');
                let corpCount = 0;
                if (corpSnap.exists()) {
                    Object.values(corpSnap.val()).forEach(topic => {
                        if (typeof topic === 'object') {
                            Object.values(topic).forEach(diff => {
                                if (typeof diff === 'object') corpCount += Object.keys(diff).length;
                            });
                        }
                    });
                }
                document.getElementById('statCorpFin').textContent = corpCount;
                document.getElementById('corpfinCurrentCount').textContent = corpCount;
                
                // Users
                const usersSnap = await db.ref('users').once('value');
                document.getElementById('statUsers').textContent = usersSnap.exists() ? Object.keys(usersSnap.val()).length : 0;
                
                // Teachers
                const teachersSnap = await db.ref('teachers').once('value');
                document.getElementById('statTeachers').textContent = teachersSnap.exists() ? Object.keys(teachersSnap.val()).length : 0;
                
                log('activityLog', '‚úÖ Stats oppdatert', 'success');
            } catch (error) {
                console.error('Error refreshing stats:', error);
                log('activityLog', '‚ùå Feil ved oppdatering: ' + error.message, 'error');
            }
        }
        
        // ========================================
        // LOGGING
        // ========================================
        
        function log(elementId, message, type = 'info') {
            const el = document.getElementById(elementId);
            const timestamp = new Date().toLocaleTimeString('no-NO');
            const className = `log-${type}`;
            el.innerHTML += `<span class="${className}">[${timestamp}] ${message}</span>\n`;
            el.scrollTop = el.scrollHeight;
        }
        
        function clearLog(elementId) {
            document.getElementById(elementId).innerHTML = '';
        }
        
        // ========================================
        // WIKI SEEDING
        // ========================================
        
        const wikiArticles = [
            {
                id: 'mval-3-1',
                title: 'Utg√•ende merverdiavgift',
                category: 'lovverk',
                law: 'MVAL',
                paragraph: '¬ß 3-1',
                tags: ['mva', 'utg√•ende', 'avgift', 'salg'],
                accounts: ['2700', '2701', '2702'],
                summary: 'Hovedregelen om avgiftsplikt ved omsetning',
                content: '<h2>Avgiftsplikt ved omsetning</h2><p>Det skal beregnes merverdiavgift ved omsetning av varer og tjenester i Norge.</p><h3>MVA-satser (2024)</h3><ul><li><strong>25%</strong> - Alminnelig sats</li><li><strong>15%</strong> - N√¶ringsmidler</li><li><strong>12%</strong> - Persontransport, overnatting</li><li><strong>0%</strong> - Eksport</li></ul>'
            },
            {
                id: 'mval-8-1',
                title: 'Fradragsrett for inng√•ende MVA',
                category: 'lovverk',
                law: 'MVAL',
                paragraph: '¬ß 8-1',
                tags: ['mva', 'fradrag', 'inng√•ende', 'kj√∏p'],
                accounts: ['2710', '2711'],
                summary: 'Regler for fradrag av inng√•ende merverdiavgift',
                content: '<h2>Fradragsrett</h2><p>Et registrert avgiftssubjekt har rett til fradrag for inng√•ende merverdiavgift p√• anskaffelser til bruk i den registrerte virksomheten.</p><h3>Vilk√•r</h3><ul><li>Registrert i MVA-registeret</li><li>Omsetning over kr 50 000</li><li>Til bruk i avgiftspliktig virksomhet</li><li>Gyldig dokumentasjon</li></ul>'
            },
            {
                id: 'rskl-5-3',
                title: 'Avskrivning av anleggsmidler',
                category: 'lovverk',
                law: 'RSKL',
                paragraph: '¬ß 5-3',
                tags: ['avskrivning', 'anleggsmidler', 'regnskap'],
                accounts: ['1000', '1200', '6000'],
                summary: 'Regnskapslovens regler om avskrivning',
                content: '<h2>Avskrivning</h2><p>Anleggsmidler med begrenset levetid skal avskrives etter en fornuftig plan.</p><h3>Metoder</h3><ul><li>Line√¶r avskrivning</li><li>Saldoavskrivning</li><li>Produksjonsenhetsmetoden</li></ul>'
            },
            {
                id: 'formula-roe',
                title: 'Egenkapitalrentabilitet (ROE)',
                category: 'formler',
                tags: ['rentabilitet', 'n√∏kkeltall', 'roe', 'egenkapital'],
                summary: 'M√•l p√• avkastning p√• egenkapitalen',
                content: '<h2>Egenkapitalrentabilitet</h2><div class="wiki-formula-box"><div class="wiki-formula">ROE = (Ordin√¶rt resultat / Gj.snitt EK) √ó 100%</div></div><h3>Tolkning</h3><ul><li><strong>&gt; 15%:</strong> God</li><li><strong>10-15%:</strong> Akseptabel</li><li><strong>&lt; 10%:</strong> Svak</li></ul>'
            },
            {
                id: 'formula-likviditetsgrad',
                title: 'Likviditetsgrad 1 og 2',
                category: 'formler',
                tags: ['likviditet', 'n√∏kkeltall', 'betalingsevne'],
                summary: 'M√•l p√• kortsiktig betalingsevne',
                content: '<h2>Likviditetsgrad</h2><div class="wiki-formula-box"><div class="wiki-formula">LG1 = Oml√∏psmidler / Kortsiktig gjeld</div></div><div class="wiki-formula-box"><div class="wiki-formula">LG2 = (Oml√∏psmidler - Varelager) / Kortsiktig gjeld</div></div><h3>Tommelfingerregler</h3><ul><li>LG1 > 2: God</li><li>LG2 > 1: God</li></ul>'
            },
            {
                id: 'concept-debet-kredit',
                title: 'Debet og Kredit',
                category: 'konsepter',
                tags: ['debet', 'kredit', 'bokf√∏ring', 'grunnleggende'],
                summary: 'Grunnleggende om debet og kredit',
                content: '<h2>Debet og Kredit</h2><p>Debet (venstre) og kredit (h√∏yre) er grunnlaget for dobbelt bokf√∏ring.</p><h3>Hovedregler</h3><table><tr><th>Kontotype</th><th>√òker i</th><th>Minker i</th></tr><tr><td>Eiendeler</td><td>DEBET</td><td>Kredit</td></tr><tr><td>Gjeld</td><td>Kredit</td><td>DEBET</td></tr><tr><td>Egenkapital</td><td>Kredit</td><td>DEBET</td></tr><tr><td>Inntekter</td><td>Kredit</td><td>DEBET</td></tr><tr><td>Kostnader</td><td>DEBET</td><td>Kredit</td></tr></table>'
            },
            {
                id: 'account-1920',
                title: 'Konto 1920 - Bankinnskudd',
                category: 'kontoplan',
                tags: ['bank', '1920', 'kontanter', 'oml√∏psmidler'],
                accounts: ['1920'],
                summary: 'Virksomhetens bankkonto',
                content: '<h2>Konto 1920</h2><p>Brukes for virksomhetens ordin√¶re bankkonto.</p><h3>Debet/Kredit</h3><ul><li><strong>Debet:</strong> Innbetalinger</li><li><strong>Kredit:</strong> Utbetalinger</li></ul>'
            },
            {
                id: 'account-2700',
                title: 'Konto 2700 - Utg√•ende MVA',
                category: 'kontoplan',
                tags: ['mva', 'utg√•ende', '2700'],
                accounts: ['2700'],
                summary: 'MVA som skal betales til staten',
                content: '<h2>Konto 2700</h2><p>Utg√•ende MVA beregnes ved salg og skal innbetales til staten.</p><h3>Debet/Kredit</h3><ul><li><strong>Kredit:</strong> Ved salg</li><li><strong>Debet:</strong> Ved MVA-oppgj√∏r</li></ul>'
            },
            {
                id: 'account-2710',
                title: 'Konto 2710 - Inng√•ende MVA',
                category: 'kontoplan',
                tags: ['mva', 'inng√•ende', '2710', 'fradrag'],
                accounts: ['2710'],
                summary: 'MVA p√• kj√∏p som kan fradragsf√∏res',
                content: '<h2>Konto 2710</h2><p>Inng√•ende MVA betales ved kj√∏p og trekkes fra ved MVA-oppgj√∏ret.</p><h3>Debet/Kredit</h3><ul><li><strong>Debet:</strong> Ved kj√∏p</li><li><strong>Kredit:</strong> Ved MVA-oppgj√∏r</li></ul>'
            },
            {
                id: 'sktl-14-43',
                title: 'Saldoavskrivning (skattemessig)',
                category: 'lovverk',
                law: 'SKTL',
                paragraph: '¬ß 14-43',
                tags: ['avskrivning', 'saldo', 'skatt', 'saldogrupper'],
                accounts: ['1000', '1200'],
                summary: 'Skattelovens regler om saldoavskrivning',
                content: '<h2>Saldogrupper</h2><table><tr><th>Gruppe</th><th>Beskrivelse</th><th>Sats</th></tr><tr><td>a</td><td>Kontormaskiner</td><td>30%</td></tr><tr><td>b</td><td>Goodwill</td><td>20%</td></tr><tr><td>c</td><td>Vogntog, lastebiler</td><td>24%</td></tr><tr><td>d</td><td>Personbiler, maskiner</td><td>20%</td></tr><tr><td>h</td><td>Bygg og anlegg</td><td>4%</td></tr><tr><td>i</td><td>Forretningsbygg</td><td>2%</td></tr></table>'
            }
        ];
        
        async function seedWiki() {
            clearLog('wikiLog');
            log('wikiLog', 'üå± Starter wiki-seeding...', 'info');
            
            try {
                const updates = {};
                
                wikiArticles.forEach(article => {
                    updates[`wiki/articles/${article.id}`] = {
                        ...article,
                        createdAt: Date.now(),
                        updatedAt: Date.now()
                    };
                });
                
                updates['wiki/_metadata'] = {
                    lastUpdated: Date.now(),
                    articleCount: wikiArticles.length,
                    version: '1.0.0'
                };
                
                await db.ref().update(updates);
                
                log('wikiLog', `‚úÖ Seedet ${wikiArticles.length} wiki-artikler`, 'success');
                refreshStats();
            } catch (error) {
                log('wikiLog', '‚ùå Feil: ' + error.message, 'error');
            }
        }
        
        function previewWiki() {
            clearLog('wikiLog');
            log('wikiLog', 'üìã Wiki-artikler som vil bli seedet:', 'info');
            wikiArticles.forEach((a, i) => {
                log('wikiLog', `${i+1}. ${a.title} [${a.category}]`, 'info');
            });
        }
        
        async function clearWiki() {
            if (!confirm('Er du sikker p√• at du vil slette alle wiki-artikler?')) return;
            
            try {
                await db.ref('wiki').remove();
                log('wikiLog', 'üóëÔ∏è Wiki t√∏mt', 'warning');
                refreshStats();
            } catch (error) {
                log('wikiLog', '‚ùå Feil: ' + error.message, 'error');
            }
        }
        
        async function addWikiArticle() {
            const article = {
                id: document.getElementById('wikiTitle').value.toLowerCase().replace(/[^a-z0-9√¶√∏√•]/g, '-').replace(/-+/g, '-'),
                title: document.getElementById('wikiTitle').value,
                category: document.getElementById('wikiCategory').value,
                law: document.getElementById('wikiLaw').value || null,
                paragraph: document.getElementById('wikiParagraph').value || null,
                tags: document.getElementById('wikiTags').value.split(',').map(t => t.trim()).filter(t => t),
                accounts: document.getElementById('wikiAccounts').value.split(',').map(a => a.trim()).filter(a => a),
                summary: document.getElementById('wikiSummary').value,
                content: document.getElementById('wikiContent').value,
                createdAt: Date.now(),
                updatedAt: Date.now()
            };
            
            if (!article.title || !article.content) {
                log('wikiLog', '‚ùå Tittel og innhold er p√•krevd', 'error');
                return;
            }
            
            try {
                await db.ref(`wiki/articles/${article.id}`).set(article);
                log('wikiLog', `‚úÖ Artikkel "${article.title}" lagt til`, 'success');
                
                // Clear form
                document.getElementById('wikiTitle').value = '';
                document.getElementById('wikiLaw').value = '';
                document.getElementById('wikiParagraph').value = '';
                document.getElementById('wikiTags').value = '';
                document.getElementById('wikiAccounts').value = '';
                document.getElementById('wikiSummary').value = '';
                document.getElementById('wikiContent').value = '';
                
                refreshStats();
            } catch (error) {
                log('wikiLog', '‚ùå Feil: ' + error.message, 'error');
            }
        }
        
        function loadWikiArticles() {
            refreshStats();
            log('wikiLog', 'üîÑ Wiki-status oppdatert', 'info');
        }
        
        // ========================================
        // QUIZ SEEDING
        // ========================================
        
        async function seedQuiz() {
            clearLog('quizLog');
            log('quizLog', 'üå± Quiz-seeding krever importert data...', 'warning');
            log('quizLog', 'For √• seede quiz, m√• du f√∏rst eksportere sp√∏rsm√•l fra quiz_updated.html', 'info');
            log('quizLog', 'Bruk "Legg til nytt sp√∏rsm√•l" for √• legge til manuelt', 'info');
        }
        
        function previewQuiz() {
            clearLog('quizLog');
            log('quizLog', 'üìã Quiz preview - krever importert data', 'info');
        }
        
        function loadQuizStats() {
            refreshStats();
            log('quizLog', 'üîÑ Quiz-status oppdatert', 'info');
        }
        
        async function addQuizQuestion() {
            const category = document.getElementById('quizCategory').value;
            const type = document.getElementById('quizType').value;
            const question = document.getElementById('quizQuestion').value;
            const optionsStr = document.getElementById('quizOptions').value;
            const answer = document.getElementById('quizAnswer').value;
            const explanation = document.getElementById('quizExplanation').value;
            const law = document.getElementById('quizLaw').value;
            
            if (!question || !answer) {
                log('quizLog', '‚ùå Sp√∏rsm√•l og svar er p√•krevd', 'error');
                return;
            }
            
            let options = [];
            if (type === 'mc' && optionsStr) {
                try {
                    options = JSON.parse(optionsStr);
                } catch (e) {
                    log('quizLog', '‚ùå Ugyldig JSON for alternativer', 'error');
                    return;
                }
            }
            
            const id = 'q_' + Date.now();
            const questionObj = {
                type: type,
                q: question,
                o: options.length ? options : undefined,
                a: type === 'mc' ? parseInt(answer) : answer,
                e: explanation || undefined,
                l: law || undefined
            };
            
            try {
                await db.ref(`questions/quiz/${category}/${id}`).set(questionObj);
                log('quizLog', `‚úÖ Sp√∏rsm√•l lagt til i ${category}`, 'success');
                
                // Clear form
                document.getElementById('quizQuestion').value = '';
                document.getElementById('quizOptions').value = '';
                document.getElementById('quizAnswer').value = '';
                document.getElementById('quizExplanation').value = '';
                document.getElementById('quizLaw').value = '';
                
                refreshStats();
            } catch (error) {
                log('quizLog', '‚ùå Feil: ' + error.message, 'error');
            }
        }
        
        // ========================================
        // BOKF√òRING SEEDING
        // ========================================
        
        async function seedBokforing() {
            clearLog('bokforingLog');
            log('bokforingLog', 'üå± Bokf√∏ring-seeding krever importert data...', 'warning');
            log('bokforingLog', 'For √• seede bokf√∏ring, m√• du f√∏rst eksportere oppgaver fra bokforingsspill_excel.html', 'info');
        }
        
        function loadBokforingStats() {
            refreshStats();
            log('bokforingLog', 'üîÑ Bokf√∏ring-status oppdatert', 'info');
        }
        
        // ========================================
        // CORPORATE FINANCE SEEDING
        // ========================================
        
        async function seedCorpFin() {
            clearLog('corpfinLog');
            log('corpfinLog', 'üå± Laster Corp Fin seed script...', 'info');
            log('corpfinLog', 'Bruker seed-corporate-finance.js hvis tilgjengelig', 'info');
            
            // Check if CorporateFinanceSeeder is available
            if (typeof CorporateFinanceSeeder !== 'undefined') {
                try {
                    const result = await CorporateFinanceSeeder.seed(db);
                    if (result.success) {
                        log('corpfinLog', `‚úÖ Seedet ${result.count} corporate finance sp√∏rsm√•l`, 'success');
                    } else {
                        log('corpfinLog', '‚ùå ' + result.error, 'error');
                    }
                } catch (error) {
                    log('corpfinLog', '‚ùå Feil: ' + error.message, 'error');
                }
            } else {
                log('corpfinLog', '‚ö†Ô∏è CorporateFinanceSeeder ikke lastet', 'warning');
                log('corpfinLog', 'Last inn seed-corporate-finance.js f√∏rst', 'info');
            }
        }
        
        function loadCorpFinStats() {
            refreshStats();
            log('corpfinLog', 'üîÑ Corp Fin-status oppdatert', 'info');
        }
        
        // ========================================
        // DATABASE EXPLORER
        // ========================================
        
        let currentDbPath = null;
        
        async function loadDbNode(path) {
            if (!path) return;
            
            currentDbPath = path;
            document.getElementById('dbCurrentPath').textContent = path;
            
            try {
                const snap = await db.ref(path).once('value');
                const data = snap.val();
                document.getElementById('dbEditor').value = JSON.stringify(data, null, 2);
            } catch (error) {
                document.getElementById('dbEditor').value = 'Feil: ' + error.message;
            }
        }
        
        function formatJson() {
            const editor = document.getElementById('dbEditor');
            try {
                const data = JSON.parse(editor.value);
                editor.value = JSON.stringify(data, null, 2);
            } catch (error) {
                alert('Ugyldig JSON: ' + error.message);
            }
        }
        
        async function saveDbNode() {
            if (!currentDbPath) {
                alert('Velg en node f√∏rst');
                return;
            }
            
            if (!confirm(`Lagre endringer til ${currentDbPath}?`)) return;
            
            try {
                const data = JSON.parse(document.getElementById('dbEditor').value);
                await db.ref(currentDbPath).set(data);
                alert('Lagret!');
                refreshStats();
            } catch (error) {
                alert('Feil: ' + error.message);
            }
        }
        
        async function deleteDbNode() {
            if (!currentDbPath) {
                alert('Velg en node f√∏rst');
                return;
            }
            
            if (!confirm(`SLETT ${currentDbPath}? Dette kan ikke angres!`)) return;
            
            try {
                await db.ref(currentDbPath).remove();
                document.getElementById('dbEditor').value = '';
                alert('Slettet!');
                refreshStats();
            } catch (error) {
                alert('Feil: ' + error.message);
            }
        }
        
        // ========================================
        // SETTINGS
        // ========================================
        
        function showRules() {
            const rules = `Se firebase-rules-complete.json for komplette regler`;
            alert(rules);
        }
        
        function copyRules() {
            alert('Last ned firebase-rules-complete.json fra outputs-mappen');
        }
        
        async function clearAllData() {
            if (!confirm('‚ö†Ô∏è ADVARSEL: Dette sletter ALL data i databasen! Er du HELT sikker?')) return;
            if (!confirm('Siste sjanse - vil du virkelig slette ALT?')) return;
            
            try {
                // Don't delete everything - keep some structure
                await db.ref('wiki').remove();
                await db.ref('questions').remove();
                alert('Data slettet');
                refreshStats();
            } catch (error) {
                alert('Feil: ' + error.message);
            }
        }
    </script>
    
    <!-- Optional: Load external seed scripts -->
    <!-- <script src="seed-corporate-finance.js"></script> -->
</body>
</html>
