<!DOCTYPE html>
<html lang="no">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Case Studies - Avansert Regnskap</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: #1e1e1e; color: #e0e0e0; min-height: 100vh; }
        .game-header { background: #2d2d2d; border-bottom: 2px solid #404040; padding: 15px 30px; display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px; }
        .back-btn { background: #404040; color: #e0e0e0; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-weight: bold; transition: all 0.3s; }
        .back-btn:hover { background: #4ade80; color: #1e1e1e; }
        .stat-item { background: #404040; padding: 8px 15px; border-radius: 5px; font-size: 0.95em; }
        .stat-value { color: #4ade80; font-weight: bold; }
        .game-content { display: flex; min-height: calc(100vh - 100px); }
        .sidebar { width: 320px; background: #2d2d2d; border-right: 2px solid #404040; overflow-y: auto; padding: 20px; }
        .task-item { background: #404040; padding: 15px; border-radius: 8px; cursor: pointer; transition: all 0.3s; border-left: 3px solid transparent; margin-bottom: 10px; }
        .task-item:hover { background: #4a4a4a; border-left-color: #4ade80; }
        .task-item.active { background: rgba(74, 222, 128, 0.2); border-left-color: #4ade80; }
        .workspace { flex: 1; padding: 30px; overflow-y: auto; }
        .task-header { background: #2d2d2d; border: 2px solid #404040; border-radius: 10px; padding: 20px; margin-bottom: 20px; }
        .task-title { font-size: 1.8em; color: #4ade80; margin-bottom: 15px; }
        .excel-grid { background: #2d2d2d; border: 2px solid #404040; border-radius: 10px; padding: 20px; margin-bottom: 20px; }
        .spreadsheet { width: 100%; border-collapse: collapse; background: #1e1e1e; }
        .spreadsheet th { background: #404040; color: #9ca3af; padding: 10px; border: 1px solid #555; text-align: center; }
        .spreadsheet td { border: 1px solid #555; padding: 0; }
        .cell { width: 100%; background: transparent; border: none; color: #e0e0e0; padding: 10px; font-family: 'Consolas', monospace; text-align: right; }
        .cell:focus { outline: 2px solid #4ade80; background: #2d2d2d; }
        .cell.readonly { background: #2d2d2d; color: #9ca3af; }
        .cell.text-cell { text-align: left; }
        .action-btn { padding: 15px 40px; border: none; border-radius: 10px; font-size: 1.1em; font-weight: bold; cursor: pointer; transition: all 0.3s; margin: 10px 5px; }
        .action-btn.check { background: #4ade80; color: #1e1e1e; }
        .action-btn.hint { background: #f59e0b; color: white; }
        .feedback { background: #2d2d2d; border: 2px solid #404040; border-radius: 10px; padding: 20px; margin-top: 20px; text-align: center; font-size: 1.2em; display: none; }
        .feedback.show { display: block; }
        .feedback.correct { border-color: #4ade80; color: #4ade80; }
        .feedback.incorrect { border-color: #ef4444; color: #ef4444; }
    </style>
</head>
<body>
    <div class="game-header">
        <button class="back-btn" onclick="window.location.href='index.html'">‚Üê Tilbake</button>
        <div class="stat-item">Modul: <span class="stat-value">Case Studies</span></div>
        <div class="stat-item">Oppgave: <span class="stat-value"><span id="current-task">1</span>/15</span></div>
    </div>

    <div class="game-content">
        <div class="sidebar" id="sidebar">
            <h3 style="color: #4ade80; margin-bottom: 15px;">üíº Case-oppgaver</h3>
            <div id="task-list"></div>
        </div>

        <div class="workspace">
            <div id="task-content"></div>
            
            <div style="text-align: center; margin-top: 20px;">
                <button class="action-btn hint" onclick="showHint()">üí° Hint</button>
                <button class="action-btn check" onclick="checkAnswer()">‚úì Sjekk svar</button>
            </div>

            <div class="feedback" id="feedback"></div>
            <div id="hint-box" style="background: #2d2d2d; border: 2px solid #f59e0b; border-radius: 10px; padding: 20px; margin-top: 20px; display: none;">
                <div style="color: #f59e0b; font-weight: bold; margin-bottom: 10px;">üí° Hint:</div>
                <div id="hint-content"></div>
            </div>
        </div>
    </div>

    <script>
        const tasks = [
            {
                id: 1,
                title: "Case 1: Resultatdisponering",
                category: "√Örsavslutning",
                description: `
                    <h4>Alpha AS - Resultatdisponering for 20x5</h4>
                    <p>√Örets resultat er kr 800 000 (overskudd). Styret foresl√•r:</p>
                    <ul>
                        <li>Utbytte: kr 300 000</li>
                        <li>Resten til annen egenkapital</li>
                    </ul>
                    <p><strong>Oppgave:</strong> Fyll inn disponeringen</p>
                `,
                hint: "Utbytte = 300 000 til konto 2800. Rest = 500 000 til konto 2050.",
                solution: [[300000, 500000]]
            },
            {
                id: 2,
                title: "Case 2: Feils√∏king",
                category: "Feils√∏king",
                description: `
                    <h4>Beta AS - Finn feilen</h4>
                    <p>Regnskapet balanserer ikke:</p>
                    <ul>
                        <li>Total debet: 180 000</li>
                        <li>Total kredit: 189 000</li>
                        <li>Differanse: 9 000</li>
                    </ul>
                    <p>Problemet: L√∏nn bokf√∏rt med brutto kr 30 000, men skattetrekk er kr 9 000.</p>
                    <p><strong>Oppgave:</strong> Hva skulle nettoutbetalingen v√¶rt?</p>
                `,
                hint: "Netto = Brutto - Skattetrekk = 30 000 - 9 000 = 21 000",
                solution: [[21000]]
            }
        ];

        let gameState = { currentTask: 0, completedTasks: [] };

        function init() {
            loadTaskList();
            loadTask(0);
        }

        function loadTaskList() {
            const list = document.getElementById('task-list');
            list.innerHTML = tasks.map((task, i) => `
                <div class="task-item ${i === gameState.currentTask ? 'active' : ''}" 
                     onclick="loadTask(${i})">
                    <div style="font-weight: bold;">${task.title}</div>
                    <div style="font-size: 0.85em; color: #9ca3af;">${task.category}</div>
                </div>
            `).join('');
        }

        function loadTask(index) {
            gameState.currentTask = index;
            const task = tasks[index];
            
            document.getElementById('current-task').textContent = index + 1;
            document.getElementById('task-content').innerHTML = `
                <div class="task-header">
                    <div class="task-title">${task.title}</div>
                    <div>${task.description}</div>
                </div>
                <div class="excel-grid">
                    <table class="spreadsheet">
                        <thead>
                            <tr><th>#</th><th>Beskrivelse</th><th>Bel√∏p</th></tr>
                        </thead>
                        <tbody id="table-body"></tbody>
                    </table>
                </div>
            `;
            
            // Add input rows based on solution length
            const tbody = document.getElementById('table-body');
            task.solution[0].forEach((_, i) => {
                tbody.innerHTML += `
                    <tr>
                        <td style="padding: 10px; text-align: center;">${i+1}</td>
                        <td style="padding: 10px;">Post ${i+1}</td>
                        <td style="padding: 0;">
                            <input type="number" class="cell" data-row="0" data-col="${i}" 
                                   placeholder="Bel√∏p" style="text-align: right;">
                        </td>
                    </tr>
                `;
            });
            
            loadTaskList();
            document.getElementById('feedback').className = 'feedback';
            document.getElementById('hint-box').style.display = 'none';
        }

        function checkAnswer() {
            const task = tasks[gameState.currentTask];
            const inputs = document.querySelectorAll('.cell');
            let correct = 0;
            
            inputs.forEach((input, i) => {
                const value = parseFloat(input.value) || 0;
                const expected = task.solution[0][i];
                if (Math.abs(value - expected) < 1) correct++;
            });
            
            const feedback = document.getElementById('feedback');
            feedback.className = 'feedback show ' + (correct === inputs.length ? 'correct' : 'incorrect');
            feedback.textContent = correct === inputs.length ? 
                'üéâ Riktig! Flott jobbet!' : 
                `‚úó ${correct}/${inputs.length} riktige. Pr√∏v igjen!`;
        }

        function showHint() {
            const task = tasks[gameState.currentTask];
            document.getElementById('hint-content').innerHTML = task.hint;
            document.getElementById('hint-box').style.display = 'block';
        }

        window.onload = init;
    </script>
</body>
</html>
